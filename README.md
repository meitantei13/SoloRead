# Solo Read
誰にも見られない、自分だけの読書管理アプリ

![Image](https://github.com/user-attachments/assets/bf98e7d5-7b9f-447a-a52a-b660f4906b49)

## サービスURL
https://solo-read.click

## 目次
- [サービス概要](#サービス概要)
- [主な機能](#主な機能)
- [技術スタック](#技術スタック)
　- [技術選定理由](#技術選定理由)
- [画面操作](#画面操作)
- [システム構成](#システム構成)
  - [インフラ構成図](#インフラ構成図)
  - [ER図](#er図)
- [設計で工夫した点](#設計で工夫した点)
  - [完全非公開設計](#完全非公開設計)
  - [Rails API ✕ Next.js の分離構成](#rails-api--nextjs-の分離構成)
  - [ゲストユーザーの仕様設計](#ゲストユーザーの仕様設計)
- [苦労した点・学んだこと](#苦労した点学んだこと)
  - [ログインが不安定になる問題の原因調査と改善](#ログインが不安定になる問題の原因調査と改善)
  - [ゲストユーザーの自動削除機能の実装](#ゲストユーザーの自動削除機能の実装)
  - [読了日登録時のカレンダーUIの調整](#読了日登録時のカレンダーuiの調整)
- [ユーザーフィードバックをもとに改善した点](#ユーザーフィードバックをもとに改善した点)
- [今後の改善予定](#今後の改善予定)


## サービス概要
「Solo Read」は、誰にも見られない **自分のための読書記録** に特化した個人用読書管理アプリです。

多くの読書記録アプリでは、感想を登録すると自動で公開され、他ユーザーの目に触れるものが多くあります。

そのため、読書の感想を書く際に
- 他ユーザーの評価を意識してしまう
- 本音よりも無難な感想になってしまう
- 「自分の素直な感想記録」にならない

と感じることがありました。

そこで、誰からも見られないことを前提に、**素直な感想や考えをそのまま残せる自分専用の読書管理アプリ** として「Solo Read」を開発しました。


## 主な機能
- **ユーザー登録（メール認証あり） / ログイン・ログアウト**
  メールアドレスとパスワードによる登録後、認証メールで本人確認を行う認証フローを実装

- **ゲストログイン**
  アカウント作成せずに、すぐにアプリを体験可能

- **読書記録の登録・編集・削除**
  読んだ本の感想や気づきを自由に記録

- **読書中保存機能**
  読書中の感想を途中で保存し、後から編集可能

- **読書記録一覧**
  これまで読んだ本を一覧で表示

- **読書中一覧**
  保存中の読書中記事を一覧で表示

- **読書記録の検索（非同期）**
  本一覧&検索ページ上部の検索バーから即時検索が可能

- **読書冊数の可視化（マイページ）**
  今月・今年・累計で読書量を確認可能


## 技術スタック

| 分類 | 技術 |
| --- | --- |
| フロントエンド | Next.js / TypeScript |
| バックエンド | Ruby on Rails (APIモード) |
| 認証 | Devise / Devise Token Auth |
| データベース | MySQL |
| 非同期処理 | Sidekiq (sidekiq-cron) |
| キャッシュ / キュー | Redis |
| インフラ | AWS |
| 開発環境 | Docker / Docker Compose |

フロントエンドでは Next.js を使用し、Rails API と通信する SPA 構成としています。  
データ取得には SWR を用い、キャッシュや再検証を行っています。  

※ フロントエンドでは MUI / shadcn/ui を用いてUI を構築し、ESLint / Prettier によるコード品質の維持を行っています。
バックエンドでは RSpec を用いたテストを導入しています。

### 技術選定理由

**フロントエンド：Next.js (TypeScript)**
読書記録の検索や一覧更新、編集状態の切り替えなど、ユーザー操作に応じて画面が頻繁に変化するアプリのため、
画面上で多くの状態と非同期通信を扱う必要があるため、React ベースの Next.js を採用しました。

コンポーネント単位で状態を管理し、さまざまな情報を独立して制御できるため、  
UI が複雑化しても破綻しにくい構成を実現できます。

また、TypeScript により API のレスポンスや画面で扱うデータ構造を型として定義することで、  
フロントエンドとバックエンドの不整合を防ぎながら、安全に実装できるようにしています。

SWR を用いたデータ取得とキャッシュ制御により、  
検索や画面遷移時に無駄な再取得を抑えつつ、常に最新のデータを表示できる構成としました。


**バックエンド：Ruby on Rails (API モード)**
認証・バリデーション・データ管理といった Web アプリケーションの基盤機能を効率よく実装できるため、  
バックエンドには Ruby on Rails を API サーバーとして採用しました。

また、日本語の情報や実務での利用事例が多く、API 開発に関するノウハウも豊富な点を重視しています。  
これにより、問題発生時にも解決策を見つけやすく、開発スピードを維持しながら安定した改善が行えると考えました。

フロントエンドを Next.js と分離した API 構成とすることで、UI 側の実装に影響を与えずに認証やデータ構造を変更でき、  
保守性と拡張性を意識した設計としています。

**インフラ：AWS + Docker**

実務で広く利用されている構成に近い形で運用経験を積むことを目的として、  インフラには AWS と Docker を採用しました。

アプリケーションをコンテナ化し、ECS（Fargate）上で実行することで、  開発環境と本番環境の差異を小さく保ち、安定したデプロイと運用ができる構成としています。

また、ALB によるトラフィックの分離と、RDS によるデータベースの管理を組み合わせることで、  フロントエンドとバックエンドを独立してスケール・更新できる設計としました。

これにより、機能追加やデプロイ時にもサービス全体を停止させずに運用できる構成としています。


## 画面操作

### 新規登録・ログイン

新規登録・ログイン方法は以下の３通りです。
①ゲストログイン
②メールアドレスとパスワードで新規登録
③メールアドレスとパスワードでログイン

※動画ではゲストログインを表示しています。
※ゲストログインでは自動でサンプルデータが追加されています。

![Image](https://github.com/user-attachments/assets/bb9c2dbd-4902-4548-b201-17747b465880)

### 記事の新規登録

記事の新規登録画面です。
登録には以下の４項目の入力があります。
①書名
②著者
③読了日
④感想

各項目を入力後、画面上部で**読書中**か**読了済**を選択し、**更新する**ボタンを押します。

![Image](https://github.com/user-attachments/assets/8662e259-a211-47f6-a403-4aaeb43a11a4)

### 登録一覧からデータを検索

本一覧＆検索画面から、読了済で登録したデータを検索することができます。
検索バーに入力すると自動で検索が開始されます。
検索範囲は**書名**と**著者**です。

![Image](https://github.com/user-attachments/assets/d8b9ca08-9ca1-4b32-9859-9a0b4ddf943b)

## システム構成
### インフラ構成図
#### 全体構成
- フロントエンドとバックエンドを AWS 上で分離構成として構築
- Route53 による DNS 管理
- ACM による SSL / TLS 証明書の管理
- ALB を経由して Frontend / Backend へリクエストを振り分け

#### フロントエンド (ECS / Fargate)
- Next.js を Docker コンテナとして ECS 上で実行
- ALB 経由でアクセスを受け付ける構成
- GitHub Actions を用いた CI / CD により自動デプロイパイプラインを構築

#### バックエンド (ECS / Fargate)
- Rails API を Docker コンテナとして ECS 上で実行
- データベースは RDS (MySQL) を Private Subnet に配置
- GitHub Actions と ECR を連携した自動デプロイパイプラインを構築

![Image](https://github.com/user-attachments/assets/bf98e7d5-7b9f-447a-a52a-b660f4906b49)

### ER図
- ユーザーごとに読書記録を管理するため、User と Book を**1対多**の関係で設計しています

![Image](https://github.com/user-attachments/assets/096f5ed7-1baf-452a-8795-5e38d296a84d)


## 設計で工夫した点
### 完全非公開設計
本アプリは、誰にも見られない「自分だけの読書記録」を前提としているため、他ユーザーのデータが表示・検索されない完全非公開設計としています。  
全ての読書記録はユーザー単位で管理し、認証されたユーザー本人のみが自分のデータにアクセスできるようにしています。

### Rails API ✕ Next.js の分離構成
バックエンドは Rails を API モードで構築し、  
フロントエンドは Next.js による SPA 構成としています。  
責務を分離することで、フロントエンドとバックエンドを独立して開発・保守できる構成を意識しました。

### ゲストユーザーの仕様設計
ゲストログイン機能を実装するにあたり、**１つのアカウントを使い回す方法** と **利用ごとに新規ゲストユーザーを作成する方法** の２案を検討しました。  
複数人が同時に利用できることや、他人のデータが残らないことを重視し、後者の仕様を採用しました。  
その結果、一定期間経過後に不要となるデータが発生することを想定したため、データのライフサイクルを意識した設計を行いました。


## 苦労した点・学んだこと
### ログインが不安定になる問題の原因調査と改善
ログインできる時とできない時が交互に発生する現象が起き、登録ユーザー・ゲストユーザーの両方で同様の現象が確認されました。  
認証トークンだけでなく、フロントエンド側のユーザー状態管理にも原因があると考え、ログアウト時の状態を見直しました。  
その結果、認証情報の取得状態を適切に初期化することで、ログイン処理が安定するようになり、状態管理の重要性を学びました。

### ゲストユーザーの自動削除機能の実装
新規ゲストユーザーを都度作成する仕様にしたことで、不要となるゲストユーザーのデータをどのように削除するか悩みました。  
当初は別の方法で定期削除を実装しようとしましたが、エラーが多発し、実装を完了させることができませんでした。  
そのため、実行方法を見直し、Rails アプリケーション内で定期処理を管理できる構成へ切り替えました。  
この経験から、実装が難航した場合でも要件を見直し、別の方法を検討する柔軟さの重要性を学びました。

### 読了日登録時のカレンダーUIの調整
当初は読了日を文字列入力で受け付けていましたが、入力の手間やミスを減らすために、カレンダーから日付を選択できるUIに変更しました。  
実装にあたっては、カレンダーUIが扱う Date 型と、フォームやAPIで扱う文字列形式の違いを意識する必要があり、日付データの管理方法に苦労しました。  
表示用の日付、フォームの値、バックエンドへ送信するデータをそれぞれ整理しながら実装することで、UIとデータの役割を分けて設計する重要性を学びました。


## ユーザーフィードバックをもとに改善した点
- **記事登録・編集時に入力した改行が、記事詳細画面で反映されない**  
実際の利用者からの指摘を受け、表示方法を見直すことで、入力時の改行がそのまま表示に反映されるよう改善しました。


## 今後の改善予定
- 記事一覧について、読了日の昇順・降順を切り替えられる並び替え機能の追加を検討しています。